"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[8593],{1737:(e,t,n)=>{n.d(t,{Z:()=>u});var a=n(3073),r=n(629);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function s(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==o(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!==o(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===o(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const l={props:{userCanSection:{type:String,default:""},userCanBtn:{type:String,default:""},userCanBack:{type:String},address:{type:String},title:{type:String},buttonText:{type:String},btnView:{type:Boolean,default:!1},urlPage:{type:String,default:""}},computed:function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},(0,r.Se)(a.z,["fixedBarAction"]))};const u=(0,n(1900).Z)(l,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.userCan(e.userCanSection)||""==e.userCanSection?n("section",{staticClass:"flex flex-row items-center mb-6 ",class:{"fixed top-0 z-20 bg-white shadow-md p-3 right-0 w-full-side justify-between":e.fixedBarAction}},[n("h1",{staticClass:"font-medium text-lg",class:e.fixedBarAction?"mr-8":"mr-auto",domProps:{textContent:e._s(e.title)}}),e._v(" "),n("section",{staticClass:"flex flex-row"},[e.userCan(e.userCanBack)?n("inertia-link",{staticClass:"\n                button button-default-responsive button-primary-subtle\n                flex flex-row items-center mr-2\n            ",attrs:{href:e.$route(e.address)}},[n("icon-chevron-left",{staticClass:"w-5 md:mr-2"}),e._v(" "),n("span",{staticClass:"hidden md:inline"},[e._v("\n                Back\n            ")])],1):e._e(),e._v(" "),e.userCan(e.userCanBtn)||""==e.userCanBtn?n("button",{staticClass:"\n                button button-default-responsive button-primary\n                flex flex-row items-center\n            ",attrs:{type:"submit"}},[n("icon-save",{staticClass:"w-5 md:mr-2"}),e._v(" "),n("span",{staticClass:"hidden md:inline",domProps:{textContent:e._s(e.buttonText)}})],1):e._e()],1)]):e._e()}),[],!1,null,null,null).exports},9223:(e,t,n)=>{n.r(t),n.d(t,{default:()=>v});var a=n(6486),r=n.n(a),o=n(1304),i=n.n(o),s=n(799),l=n(5591),u=n(1737),c=n(3073),p=n(629);function m(e){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m(e)}function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){y(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function y(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==m(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!==m(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===m(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var g=axios.CancelToken,b=g.source();const h={name:"AdminCmsLayoutCreate",components:{InputGroup:s.Z,SelectGroup:l.Z,TopOptionSection:u.Z},layout:"admin-layout",props:{layout:{type:Object,required:!0},templates:{type:Object,required:!0},layoutTypes:{type:Object,required:!0}},data:function(){return{autoUpdateSlug:!1,formData:{},isInitialisedTemplate:!1,isInitialisedContent:!1,isLoadingTemplate:!1,selectedTemplate:null}},computed:f(f({},(0,p.Se)(c.z,["fixedBarAction"])),{},{selectedTemplateHasFields:function(){try{return!!this.selectedTemplate&&this.selectedTemplate.template_fields.length}catch(e){return!1}},selectedTemplateId:function(){var e;return null!==(e=this.formData.template_id)&&void 0!==e?e:""}}),created:function(){this.formData={content:{},id:this.layout.id,name:this.layout.name,slug:this.layout.slug,type:this.layout.type,template_id:this.layout.template_id},this.selectedTemplate=r().cloneDeep(this.layout.template),this.setInitialContent()},methods:{cancelLoadTemplate:function(){this.isLoadingTemplate&&(b.cancel("Template load cancelled"),b=g.source())},doesObjectHaveKeys:function(e){try{return Object.keys(e).length}catch(e){return!1}},layoutHasContentField:function(e){try{return this.layout.content.hasOwnProperty(e)}catch(e){return!1}},onNameInput:function(){this.autoUpdateSlug&&(this.formData.slug=this.slugify(this.formData.name))},onSelectedTemplateIdChange:r().debounce((function(){var e=this;this.isInitialisedTemplate?(this.selectedTemplate=null,this.cancelLoadTemplate(),this.selectedTemplateId&&(this.isLoadingTemplate=!0,axios.get(this.$route("admin.api.cms.templates.show",this.selectedTemplateId)).then((function(t){e.selectedTemplate=r().cloneDeep(t.data.data),e.setNewTemplateContent()})).catch((function(t){axios.isCancel(t)||(e.$errorToast("Failed to load selected template"),console.log(t))})).finally((function(){e.isLoadingTemplate=!1})))):this.isInitialisedTemplate=!0}),500),onSlugBlur:function(){this.formData.slug=this.slugify(this.formData.slug)},onSlugInput:function(){this.autoUpdateSlug=!1},setInitialContent:function(){var e=this,t={};this.doesObjectHaveKeys(this.layout.content)&&(t=r().cloneDeep(this.layout.content)),r().forEach(this.selectedTemplate.template_fields,(function(n){e.layoutHasContentField(n.id)||(t[n.id]={data:"",template_field_id:n.id})})),this.formData.content=r().cloneDeep(t),this.isInitialisedContent=!0},setNewTemplateContent:function(){this.selectedTemplateHasFields||(this.formData.content={});var e={};r().forEach(this.selectedTemplate.template_fields,(function(t){e[t.id]={data:"",template_field_id:t.id}})),this.$set(this.formData,"content",r().cloneDeep(e))},slugify:function(e){return e&&e.length?i()(e,{lower:!0}):""},submit:function(){this.$inertia.put(this.$route("admin.cms.layouts.update",this.layout.id),this.formData)}},watch:{selectedTemplateId:{handler:"onSelectedTemplateIdChange"}}};const v=(0,n(1900).Z)(h,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form",{staticClass:"max-w-5xl mx-auto",attrs:{autocomplete:"off"},on:{submit:function(t){return t.preventDefault(),e.submit.apply(null,arguments)}}},[n("TopOptionSection",{attrs:{userCanSection:"cms_advanced.edit",userCanBack:"cms_advanced.view",address:"admin.cms.layouts.index",title:"Edit Layout",buttonText:"Save Changes"}}),e._v(" "),n("div",{staticClass:"bg-white py-6 shadow-subtle rounded-lg"},[n("div",{staticClass:"block px-6 w-full"},[n("select-group",{directives:[{name:"show",rawName:"v-show",value:e.$page.props.auth.user.super,expression:"$page.props.auth.user.super"}],attrs:{"error-message":e.getPageErrorMessage("template_id"),"label-text":"Template","input-any-option-enabled":!0,"input-any-option-label":"Please select a template","input-autofocus":!0,"input-id":"template_id","input-name":"template_id","input-options":e.templates,"input-option-label-key":"name","input-option-value-key":"id","input-required":!0},on:{errorHidden:function(t){return e.clearPageErrorMessage("template_id")}},model:{value:e.formData.template_id,callback:function(t){e.$set(e.formData,"template_id",t)},expression:"formData.template_id"}}),e._v(" "),n("select-group",{directives:[{name:"show",rawName:"v-show",value:e.$page.props.auth.user.super,expression:"$page.props.auth.user.super"}],staticClass:"mt-4",attrs:{"error-message":e.getPageErrorMessage("type"),"label-text":"Layout Type","input-any-option-enabled":!0,"input-any-option-label":"Please select a layout type","input-id":"type","input-name":"type","input-options":e.layoutTypes,"input-required":!0},on:{errorHidden:function(t){return e.clearPageErrorMessage("type")}},model:{value:e.formData.type,callback:function(t){e.$set(e.formData,"type",t)},expression:"formData.type"}}),e._v(" "),n("input-group",{staticClass:"mt-4",attrs:{"error-message":e.getPageErrorMessage("name"),"input-autocomplete":"layout_name","input-id":"name","input-name":"name","input-required":!0,"input-type":"text","label-text":"Layout Name"},on:{errorHidden:function(t){return e.clearPageErrorMessage("name")},input:e.onNameInput},model:{value:e.formData.name,callback:function(t){e.$set(e.formData,"name",t)},expression:"formData.name"}}),e._v(" "),n("input-group",{directives:[{name:"show",rawName:"v-show",value:e.$page.props.auth.user.super,expression:"$page.props.auth.user.super"}],staticClass:"mt-4",attrs:{"error-message":e.getPageErrorMessage("slug"),"input-autocomplete":"layout_slug","input-id":"slug","input-name":"slug","input-required":!0,"input-type":"text","label-text":"Layout Slug"},on:{blur:e.onSlugBlur,errorHidden:function(t){return e.clearPageErrorMessage("slug")},input:e.onSlugInput},model:{value:e.formData.slug,callback:function(t){e.$set(e.formData,"slug",t)},expression:"formData.slug"}})],1)]),e._v(" "),!this.isLoadingTemplate&&e.selectedTemplateHasFields&&e.isInitialisedContent?n("div",{staticClass:"bg-white mt-6 px-4 py-6 shadow-subtle rounded-lg"},[n("p",{staticClass:"text-lg"},[e._v("Fields")]),e._v(" "),n("content-editor",{staticClass:"mt-4",attrs:{"template-fields":e.selectedTemplate.template_fields},model:{value:e.formData.content,callback:function(t){e.$set(e.formData,"content",t)},expression:"formData.content"}})],1):e._e()],1)}),[],!1,null,null,null).exports}}]);